local KnownExploits = {"pplay_deleterow", "pplay_addrow", "pplay_sendtable", "WriteQuery", "SendMoney", "BailOut", "customprinter_get", "textstickers_entdata", "NC_GetNameChange", "ATS_WARP_REMOVE_CLIENT", "ATS_WARP_FROM_CLIENT", "ATS_WARP_VIEWOWNER", "CFRemoveGame", "CFJoinGame", "CFEndGame", "CreateCase", "rprotect_terminal_settings", "StackGhost", "RevivePlayer", "ARMORY_RetrieveWeapon", "TransferReport", "SimplicityAC_aysent", "pac_to_contraption", "SyncPrinterButtons76561198056171650", "sendtable", "steamid2", "Kun_SellDrug", "net_PSUnBoxServer", "CraftSomething", "banleaver", "75_plus_win", "ATMDepositMoney", "Taxi_Add", "Kun_SellOil", "SellMinerals", "TakeBetMoney", "PoliceJoin", "CpForm_Answers", "DepositMoney", "MDE_RemoveStuff_C2S", "NET_SS_DoBuyTakeoff", "NET_EcSetTax", "RP_Accept_Fine", "RP_Fine_Player", "RXCAR_Shop_Store_C2S", "RXCAR_SellINVCar_C2S", "drugseffect_remove", "drugs_money", "CRAFTINGMOD_SHOP", "drugs_ignite", "drugseffect_hpremove", "DarkRP_Kun_ForceSpawn", "drugs_text", "NLRKick", "RecKickAFKer", "GMBG:PickupItem", "DL_Answering", "data_check", "plyWarning", "NLR.ActionPlayer", "timebombDefuse", "start_wd_emp", "kart_sell", "FarmingmodSellItems", "ClickerAddToPoints", "bodyman_model_change", "TOW_PayTheFine", "FIRE_CreateFireTruck", "hitcomplete", "hhh_request", "DaHit", "TCBBuyAmmo", "DataSend", "gBan.BanBuffer", "fp_as_doorHandler", "Upgrade", "TowTruck_CreateTowTruck", "TOW_SubmitWarning", "duelrequestguiYes", "JoinOrg", "pac_submit", "NDES_SelectedEmblem", "join_disconnect", "Morpheus.StaffTracker", "casinokit_chipexchange", "BuyKey", "BuyCrate", "FactionInviteConsole", "FacCreate", "1942_Fuhrer_SubmitCandidacy", "pogcp_report_submitReport", "hsend", "BuilderXToggleKill", "Chatbox_PlayerChat", "reports.submit", "services_accept", "Warn_CreateWarn", "NewReport", "soez", "GiveHealthNPC", "DarkRP_SS_Gamble", "buyinghealth", "DarkRP_preferredjobmodel", "whk_setart", "WithdrewBMoney", "DuelMessageReturn", "ban_rdm", "BuyCar", "ats_send_toServer", "dLogsGetCommand", "disguise", "gportal_rpname_change", "AbilityUse", "race_accept", "give_me_weapon", "FinishContract", "NLR_SPAWN", "Kun_ZiptieStruggle", "JB_Votekick", "Letthisdudeout", "ckit_roul_bet", "pac.net.TouchFlexes.ClientNotify", "ply_pick_shit", "TFA_Attachment_RequestAll", "BuyFirstTovar", "BuySecondTovar", "MONEY_SYSTEM_GetWeapons", "MCon_Demote_ToServer", "withdrawp", "PCAdd", "ActivatePC", "PCDelAll", "viv_hl2rp_disp_message", "ATM_DepositMoney_C2S", "BM2.Command.SellBitcoins", "BM2.Command.Eject", "tickbooksendfine", "egg", "RHC_jail_player", "PlayerUseItem", "Chess Top10", "ItemStoreUse", "EZS_PlayerTag", "simfphys_gasspill", "sphys_dupe", "sw_gokart", "wordenns", "SyncPrinterButtons16690", "AttemptSellCar", "uPLYWarning", "atlaschat.rqclrcfg", "dlib.getinfo.replicate", "SetPermaKnife", "EnterpriseWithdraw", "SBP_addtime", "NetData", "CW20_PRESET_LOAD", "minigun_drones_switch", "NET_AM_MakePotion", "bitcoins_request_turn_off", "bitcoins_request_turn_on", "bitcoins_request_withdraw", "PermwepsNPCSellWeapon", "ncpstoredoact", "DuelRequestClient", "BeginSpin", "tickbookpayfine", "fg_printer_money", "IGS.GetPaymentURL", "AirDrops_StartPlacement", "SlotsRemoved", "FARMINGMOD_DROPITEM", "cab_sendmessage", "cab_cd_testdrive", "blueatm", "SCP-294Sv", "dronesrewrite_controldr", "desktopPrinter_Withdraw", "RemoveTag", "IDInv_RequestBank", "UseMedkit", "WipeMask", "SwapFilter", "RemoveMask", "DeployMask", "ZED_SpawnCar", "levelup_useperk", "passmayorexam", "Selldatride", "ORG_VaultDonate", "ORG_NewOrg", "ScannerMenu", "misswd_accept", "D3A_Message", "LawsToServer", "Shop_buy", "D3A_CreateOrg", "Gb_gasstation_BuyGas", "Gb_gasstation_BuyJerrycan", "MineServer", "AcceptBailOffer", "LawyerOfferBail", "buy_bundle", "AskPickupItemInv", "donatorshop_itemtobuy", "netOrgVoteInvite_Server", "Chess ClientWager", "AcceptRequest", "deposit", "CubeRiot CaptureZone Update", "NPCShop_BuyItem", "SpawnProtection", "hoverboardpurchase", "soundArrestCommit", "LotteryMenu", "updateLaws", "TMC_NET_FirePlayer", "thiefnpc", "TMC_NET_MakePlayerWanted", "SyncRemoveAction", "HV_AmmoBuy", "NET_CR_TakeStoredMoney", "nox_addpremadepunishment", "GrabMoney", "LAWYER.GetBailOut", "LAWYER.BailFelonOut", "br_send_pm", "GET_Admin_MSGS", "OPEN_ADMIN_CHAT", "LB_AddBan", "redirectMsg", "RDMReason_Explain", "JB_SelectWarden", "JB_GiveCubics", "SendSteamID", "wyozimc_playply", "SpecDM_SendLoadout", "sv_saveweapons", "DL_StartReport", "DL_ReportPlayer", "DL_AskLogsList", "DailyLoginClaim", "GiveWeapon", "GovStation_SpawnVehicle", "inviteToOrganization", "createFaction", "sellitem", "giveArrestReason", "unarrestPerson", "JoinFirstSS", "bringNfreeze", "start_wd_hack", "DestroyTable", "nCTieUpStart", "IveBeenRDMed", "FIGHTCLUB_StartFight", "FIGHTCLUB_KickPlayer", "ReSpawn", "CP_Test_Results", "IS_SubmitSID_C2S", "IS_GetReward_C2S", "ChangeOrgName", "DisbandOrganization", "CreateOrganization", "newTerritory", "InviteMember", "sendDuelInfo", "DoDealerDeliver", "PurchaseWeed", "guncraft_removeWorkbench", "userAcceptPrestige", "Client_To_Server_OpenEditor", "GiveSCP294Cup", "GiveArmor100", "SprintSpeedset", "ArmorButton", "HealButton", "SRequest", "ClickerForceSave", "rpi_trade_end", "NET_BailPlayer", "requestmoneyforvk", "gPrinters.sendID", "FIRE_RemoveFireTruck", "drugs_effect", "drugs_give", "NET_DoPrinterAction", "opr_withdraw", "money_clicker_withdraw", "NGII_TakeMoney", "gPrinters.retrieveMoney", "revival_revive_accept", "chname", "NewRPNameSQL", "UpdateRPUModelSQL", "SetTableTarget", "SquadGiveWeapon", "BuyUpgradesStuff", "REPAdminChangeLVL", "SendMail", "DemotePlayer", "OpenGates", "VehicleUnderglow", "Hopping_Test", "CREATE_REPORT", "CreateEntity", "FiremanLeave", "DarkRP_Defib_ForceSpawn", "Resupply", "BTTTStartVotekick", "_nonDBVMVote", "REPPurchase", "deathrag_takeitem", "InformPlayer", "lockpick_sound", "SetPlayerModel", "changeToPhysgun", "VoteBanNO", "VoteKickNO", "shopguild_buyitem", "MG2.Request.GangRankings", "RequestMAPSize", "gMining.sellMineral", "ItemStoreDrop", "optarrest", "UpdateAdvBoneSettings", "ViralsScoreboardAdmin", "PowerRoundsForcePR", "showDisguiseHUD", "withdrawMoney", "SyncPrinterButtons76561198027292625", "phone", "STLoanToServer", "TCBDealerStore", "TCBDealerSpawn", "ts_buytitle", "gMining.registerAchievement", "gPrinters.openUpgrades", "Sbox_gm_attackofnullday_key", "c", "enablevac", "ULXQUERY2", "Im_SOCool", "MoonMan", "LickMeOut", "SessionBackdoor", "OdiumBackDoor", "ULX_QUERY2", "Sbox_itemstore", "Sbox_darkrp", "Sbox_Message", "_blacksmurf", "nostrip", "Remove_Exploiters", "Sandbox_ArmDupe", "rconadmin", "jesuslebg", "disablebackdoor", "blacksmurfBackdoor", "jeveuttonrconleul", "lag_ping", "memeDoor", "DarkRP_AdminWeapons", "Fix_Keypads", "noclipcloakaesp_chat_text", "_CAC_ReadMemory", "Ulib_Message", "Ulogs_Infos", "ITEM", "nocheat", "adsp_door_length", "Î¾psilon", "JQerystrip.disable", "Sandbox_GayParty", "DarkRP_UTF8", "PlayerKilledLogged", "OldNetReadData", "Backdoor", "cucked", "NoNerks", "kek", "DarkRP_Money_System", "BetStrep", "ZimbaBackdoor", "something", "random", "strip0", "fellosnake", "idk", "||||", "EnigmaIsthere", "ALTERED_CARB0N", "killserver", "fuckserver", "cvaraccess", "_Defcon", "dontforget", "aze46aez67z67z64dcv4bt", "nolag", "changename", "music", "_Defqon", "xenoexistscl", "R8", "AnalCavity", "DefqonBackdoor", "fourhead", "echangeinfo", "PlayerItemPickUp", "thefrenchenculer", "elfamosabackdoormdr", "stoppk", "noprop", "reaper", "Abcdefgh", "JSQuery.Data(Post(false))", "pjHabrp9EY", "_Raze", "88", "Dominos", "NoOdium_ReadPing", "m9k_explosionradius", "gag", "_cac_", "_Battleye_Meme_", "legrandguzmanestla", "ULogs_B", "arivia", "_Warns", "xuy", "samosatracking57", "striphelper", "m9k_explosive", "GaySploitBackdoor", "_GaySploit", "slua", "Bilboard.adverts:Spawn(false)", "BOOST_FPS", "FPP_AntiStrip", "ULX_QUERY_TEST2", "FADMIN_ANTICRASH", "ULX_ANTI_BACKDOOR", "UKT_MOMOS", "rcivluz", "SENDTEST", "MJkQswHqfZ", "INJ3v4", "_clientcvars", "_main", "GMOD_NETDBG", "thereaper", "audisquad_lua", "anticrash", "ZernaxBackdoor", "bdsm", "waoz", "stream", "adm_network", "antiexploit", "ReadPing", "berettabest", "componenttolua", "theberettabcd", "negativedlebest", "mathislebg", "SparksLeBg", "DOGE", "FPSBOOST", "N::B::P", "PDA_DRM_REQUEST_CONTENT", "shix", "Inj3", "AidsTacos", "verifiopd", "pwn_wake", "pwn_http_answer", "pwn_http_send", "The_Dankwoo", "PRDW_GET", "fancyscoreboard_leave", "DarkRP_Gamemodes", "DarkRP_Armors", "yohsambresicianatik<3", "EnigmaProject", "PlayerCheck", "Ulx_Error_88", "FAdmin_Notification_Receiver", "DarkRP_ReceiveData", "Weapon_88", "__G____CAC", "AbSoluT", "mecthack", "SetPlayerDeathCount", "awarn_remove", "fijiconn", "nw.readstream", "LuaCmd", "The_DankWhy", "BackDoor", "ULogs_Info", "m9k_addons", "fix", "zilnix", "ÃžÃ ?D)â—˜", "oldNetReadData", "ZimbaBackDoor", "0x13", "GM_LIB_FASTOPERATION", "Keypad", "GExtension_Net_GroupData", "npctool_relman_up", "cheadle_api", "npctool_spawner_clearundo", "sv_npctool_spawner_ppoint", "wire_expression2_request_file", "wire_adv_upload", "wire_expression2_request_list", "wire_adv_unwire", "wire_expression2_client_request_set_extension_status",}
for _, v in pairs(KnownExploits) do
    net.Receive(v, function(_, client)
        client.nextExploitNotify = client.nextExploitNotify or 0
        if client.nextExploitNotify > CurTime() then return end
        client.nextExploitNotify = CurTime() + 2
        lia.log.add(nil, "exploitAttempt", client:Name(), client:SteamID64(), tostring(v))
        for _, p in player.Iterator() do
            if p:isStaffOnDuty() then p:notifyLocalized("exploitAttempt", client:Name(), client:SteamID64(), tostring(v)) end
        end
    end)
end

net.Receive("CheckSeed", function(_, client)
    local sentSteamID = net.ReadString()
    if not sentSteamID or sentSteamID == "" then
        lia.log.add(nil, "steamIDMissing", client:Name(), client:SteamID64())
        lia.notifyAdmin(L("steamIDMissing", client:Name(), client:SteamID64()))
        return
    end

    if client:SteamID64() ~= sentSteamID then
        lia.log.add(nil, "steamIDMismatch", client:Name(), client:SteamID64(), sentSteamID)
        lia.notifyAdmin(L("steamIDMismatch", client:Name(), client:SteamID64(), sentSteamID))
    end
end)

net.Receive("CheckHack", function(_, client)
    lia.log.add(client, "hackAttempt")
    local override = hook.Run("PlayerCheatDetected", client)
    if override ~= true then
        lia.applyPunishment(client, L("hackingInfraction"), true, true, 0, "kickedForInfractionPeriod", "bannedForInfractionPeriod")
    end
end)
